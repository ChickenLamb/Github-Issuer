(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(5161)}])},5161:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return R}});var n=a(5893),o=a(9008),l=a.n(o),s=a(6720),r=a(2045),i=a(7294),c=a(2293),d=a(7357),u=a(155),p=a(5861),h=a(3321);function g(e){let{clientid:t}=e,a="https://github.com/login/oauth/authorize?client_id="+t+"&scope=repo";return(0,n.jsx)(d.Z,{sx:{flexGrow:1},children:(0,n.jsx)(c.Z,{position:"static",children:(0,n.jsxs)(u.Z,{children:[(0,n.jsx)(p.Z,{variant:"h6",component:"div",sx:{flexGrow:1},children:"Github Issue Controller"}),(0,n.jsx)(h.Z,{tabIndex:2,color:"inherit",onClick:()=>{window.location.assign(a)},children:"Login"})]})})})}var m=a(3795),x=a(629),y=a(6447),f=a(9661),b=a(948),j=a(6574),_=a(8376),v=a(2734),C=a(5678),Z=a(7918);function k(e){let{setTag:t,query:o,SearchQuery:l,LoadIssue:s,token:r,state:c,labels:d,labels_url:u}=e,p=a(7218),[g,m]=i.useState(null),x=Boolean(g);(0,v.Z)();let f=e=>{m(e.currentTarget)},b=()=>{m(null)},j=e=>{t(e)},k=e=>{let t=C.Am.loading("Deleting Tag...");p.request({method:"get",maxBodyLength:1/0,url:"https://github-get-token-api.vercel.app/api/delete-tag?token="+"".concat(r)+"&label_url="+"".concat(u)}).then(e=>{console.log(JSON.stringify(e.data)),200===e.status&&(C.Am.update(t,{render:"Tag Deleted Successfully",type:"success",isLoading:!1,autoClose:500}),setTimeout(()=>{o.state?l(o.q):s(!0)},500))}).catch(e=>{console.log(e),C.Am.update(t,{render:"Failed to Delete Tag",type:"error",isLoading:!1,autoClose:2500})})};return(0,n.jsxs)("div",{children:[(0,n.jsxs)(y.Z,{direction:"row",spacing:1,children:[null==d?void 0:d.map((e,t)=>(0,n.jsx)(Z.Z,{label:e.name,onClick:()=>j(e.name),onDelete:()=>k(e.url),style:{backgroundColor:"#"+e.color}},t)),(0,n.jsx)(Z.Z,{label:"+",onClick:f,component:"a",href:"#basic-chip",variant:"outlined",clickable:!0})]}),(0,n.jsx)(_.Z,{id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:g,open:x,onClose:b,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"left"},style:{marginLeft:3},children:["Open","In Progress","Done"].map((e,t)=>(0,n.jsx)(h.Z,{onClick:()=>(function(e,t){let a=C.Am.loading("Adding Tag...");p.request({method:"get",maxBodyLength:1/0,url:"https://github-get-token-api.vercel.app/api/add-tag?token="+"".concat(r)+"&labels_url="+"".concat(e)+"&tag="+"".concat(t)}).then(e=>{console.log(JSON.stringify(e.data)),200===e.status&&(C.Am.update(a,{render:"Tag Added Successfully",type:"success",isLoading:!1,autoClose:500}),setTimeout(()=>{o.state?l(o.q):s(!0)},500))}).catch(e=>{console.log(e),C.Am.update(a,{render:"Failed to Add Tag",type:"error",isLoading:!1,autoClose:2500})})})(u,e),children:e},t))})]})}var w=a(7125),S=a(8085);let A={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function L(e){let{query:t,SearchQuery:o,state:l,setState:s,token:r,LoadIssue:i}=e,c=()=>s({...l,window_state:!1});return(0,n.jsx)("div",{children:(0,n.jsx)(w.Z,{open:l.window_state,onClose:c,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,n.jsxs)(d.Z,{sx:A,children:[(0,n.jsx)(p.Z,{textAlign:"center",id:"modal-modal-title",variant:"h6",component:"h2",children:"ARE YOU SURE YOU WANT TO DELETE IT?"}),(0,n.jsxs)(S.Z,{spacing:3,children:[(0,n.jsx)(h.Z,{onClick:()=>{!function(){let e=C.Am.loading("Deleting..."),n=a(7218),c={method:"patch",maxBodyLength:1/0,url:l.close_url,headers:{Accept:"application/vnd.github+json",Authorization:"Bearer "+"".concat(r),"Content-Type":"application/json"},data:{state:"close"}};n.request(c).then(a=>{console.log(JSON.stringify(a.data)),200===a.status&&(s({...l,window_state:!1}),C.Am.update(e,{render:"Deleted Successfully",type:"success",isLoading:!1,autoClose:1500}),setTimeout(()=>{t.state?o(t.q):i(!0)},1500))}).catch(t=>{console.log(t),C.Am.update(e,{render:"Failed to Delete",type:"error",isLoading:!1,autoClose:2500})})}()},children:"CONFIRM"}),(0,n.jsx)(h.Z,{onClick:()=>{c()},children:"CANCEL"})]})]})})})}let q=(0,b.ZP)(x.Z)(e=>{let{theme:t}=e;return{backgroundColor:"dark"===t.palette.mode?"#1A2027":"#fff",...t.typography.body2,padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary}});function I(e){let{setTag:t,query:o,SearchQuery:l,Data:s,token:r,callback:c,LoadIssue:u}=e,g=(0,v.Z)(),[x,b]=i.useState({window_state:!1}),_=a(381);return(0,n.jsxs)(d.Z,{maxWidth:"md",m:"auto",py:5,sx:{width:"100%"},children:[(0,n.jsx)(y.Z,{spacing:2,children:s.map((e,a)=>(0,n.jsxs)(q,{style:{minHeight:200},children:[(0,n.jsx)(k,{setTag:t,query:o,SearchQuery:l,LoadIssue:u,token:r,labels_url:e.labels_url,state:e.state,labels:e.labels}),(0,n.jsxs)(y.Z,{direction:"row",justifyContent:"center",alignItems:"center",sx:{minWidth:0},children:[(0,n.jsxs)(j.Z,{component:"div",style:{minWidth:"80%"},children:[" ",(0,n.jsxs)(y.Z,{direction:"row",justifyContent:"left",alignItems:"center",spacing:1,ml:2,my:2,children:[(0,n.jsx)(q,{elevation:0,children:(0,n.jsx)(f.Z,{style:{marginRight:0,border:"1px solid black"},variant:"circular",alt:e.assignee_name,src:e.assignee_avatar_url})}),(0,n.jsx)(q,{elevation:0,children:(0,n.jsx)(p.Z,{variant:"h4",children:(0,n.jsx)(m.Z,{target:"_blank",href:e.html_url,underline:"hover",children:e.title})})})]}),(0,n.jsxs)(p.Z,{ml:2,my:1,textAlign:"left",component:"pre",variant:"body1",children:[(0,n.jsx)("strong",{children:"repo: "}),(0,n.jsx)(p.Z,{p:1,style:{borderRadius:5,color:g.palette.common.white,backgroundColor:g.palette.common.black},ml:1,mr:2,my:1,textAlign:"center",component:"span",variant:"body1",children:e.repository_name})," ",(0,n.jsx)("strong",{children:"created_at: "}),_(e.date_created_at).format("dddd, D/M/YYYY"),"\n","\n",(0,n.jsx)("strong",{children:"updated_at: "}),(0,n.jsx)("cite",{children:_(e.date_updated_at).format("dddd, D/M/YYYY, h:mm:ss a")})]}),(0,n.jsx)(p.Z,{style:{whiteSpace:"break-spaces"},ml:2,my:1,textAlign:"left",component:"pre",variant:"body1",children:e.body})]}),(0,n.jsxs)(j.Z,{component:"div",children:[" ",(0,n.jsxs)(y.Z,{direction:"column",justifyContent:"center",alignItems:"flex-start",spacing:1,style:{border:"1px solid black"},children:[(0,n.jsx)(q,{elevation:0,children:(0,n.jsx)(h.Z,{onClick:()=>c({body:e.body,title:e.title,open:!0,issue_url:e.url}),children:"Edit"})}),(0,n.jsx)(q,{elevation:0,children:(0,n.jsx)(h.Z,{onClick:()=>{b({window_state:!0,close_url:e.url})},children:"Delete"})})]})]})]})]},a))}),(0,n.jsx)(L,{query:o,SearchQuery:l,state:x,setState:b,token:r,LoadIssue:u})]})}var E=a(89),T=a(6357);let O={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function D(e){let{query:t,SearchQuery:o,updateForm:l,handleClose:s,token:r,LoadIssue:c}=e;async function u(e){var n;if(""!==e.title&&(null!==(n=e.body)&&void 0!==n?n:"").length>=30){let n=C.Am.loading("Updating..."),l=a(7218);console.log(e);let s={method:"patch",maxBodyLength:1/0,url:e.issue_url,headers:{Accept:"application/vnd.github+json",Authorization:"Bearer "+"".concat(r),"Content-Type":"application/json"},data:{title:e.title,body:e.body}};await l.request(s).then(e=>{200===e.status&&(C.Am.update(n,{render:"Update Successfully",type:"success",isLoading:!1,autoClose:1500}),setTimeout(()=>{t.state?o(t.q):c(!0)},1500))}).catch(e=>{console.log(e),C.Am.update(n,{render:"Failed to Update",type:"error",isLoading:!1,autoClose:2500})})}else(0,C.Am)("title 為必填,body 至少需要 30 字",{type:"error",autoClose:3500})}let[g,m]=i.useState(!1),[x,y]=i.useState({open:!1});return i.useEffect(()=>{l.open&&y(l)},[l.open]),i.useEffect(()=>console.log(x),[x]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(w.Z,{open:l.open,onClose:s,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,n.jsxs)(d.Z,{sx:O,children:[(0,n.jsxs)(p.Z,{variant:"h6",component:"span",children:["title:  ",(0,n.jsx)(E.Z,{onChange:e=>{y({...x,title:e.target.value})},defaultValue:l.title})]}),(0,n.jsx)("hr",{}),(0,n.jsx)(p.Z,{component:"span",style:{display:"flex",justifyContent:"center",alignContent:"center",padding:"5% 0"},children:(0,n.jsx)(T.Z,{fullWidth:!0,onChange:e=>{y({...x,body:e.target.value})},defaultValue:l.body,label:"Body",multiline:!0,maxRows:4})}),(0,n.jsx)("hr",{}),(0,n.jsx)(h.Z,{style:{float:"right"},onClick:()=>{u(x)},children:"Update"})]})})})}a(1399);var U=a(6886),B=a(6420);function F(){let[e,t]=i.useState(!1);return(0,n.jsx)(B.Z,{value:"check",selected:e,onChange:()=>{t(!e)},children:"滑到底部單次載入10筆"})}let N=(0,b.ZP)(x.Z)(e=>{let{theme:t}=e;return{backgroundColor:"dark"===t.palette.mode?"#1A2027":"#fff",...t.typography.body2,padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary,borderRadius:0}});function P(e){let{tag:t,setTag:a,setQuery:o,setIssues:l,token:s,LoadIssue:r,setSortOrder:u,sortOrder:g}=e,[m,x]=i.useState(""),y=(0,v.Z)(),f=e=>{"Enter"===e.key&&(e.preventDefault(),b())};function b(){o({state:!0,q:m})}return(0,n.jsx)(c.Z,{position:"sticky",children:(0,n.jsx)(d.Z,{style:{backgroundColor:y.palette.common.white},sx:{flexGrow:1},children:(0,n.jsxs)(U.ZP,{container:!0,spacing:0,children:[(0,n.jsxs)(U.ZP,{item:!0,xs:2,children:[(0,n.jsx)(N,{elevation:0,children:(0,n.jsx)(h.Z,{onClick:()=>r(!0),children:"Refresh"})}),(0,n.jsx)(N,{elevation:0,children:(0,n.jsx)(F,{})})]}),(0,n.jsxs)(U.ZP,{item:!0,xs:7,children:[(0,n.jsx)(N,{elevation:0,children:(0,n.jsxs)(d.Z,{component:"form",sx:{"& > :not(style)":{m:1.5}},style:{display:"flex"},ml:10,noValidate:!0,autoComplete:"on",children:[(0,n.jsx)(p.Z,{textAlign:"left",variant:"h6",children:"Search:"}),(0,n.jsx)(T.Z,{onKeyDown:f,onChange:e=>{x(e.target.value)},value:m,id:"outlined-basic",label:"What do you want to find?",variant:"outlined"}),(0,n.jsx)(h.Z,{onClick:()=>b(),children:"Search"}),(0,n.jsx)(h.Z,{onClick:()=>{o({state:!1,q:""}),x("")},children:"Clear Search"})]})}),(0,n.jsx)(N,{elevation:0,children:""!==t&&(0,n.jsx)(d.Z,{component:"form",sx:{"& > :not(style)":{m:1.5}},style:{display:"flex"},ml:10,noValidate:!0,autoComplete:"on",children:(0,n.jsxs)(p.Z,{textAlign:"left",variant:"h6",children:["Selected Label :"," ",(0,n.jsx)(Z.Z,{label:t,onDelete:()=>a("")})]})})})]}),(0,n.jsxs)(U.ZP,{item:!0,xs:3,style:{display:"flex",gap:1,justifyContent:"flex-end",alignItems:"flex-start"},children:[(0,n.jsx)(N,{elevation:0,children:(0,n.jsx)(p.Z,{children:"Sort:"})}),["created","updated","comments"].map((e,t)=>(0,n.jsx)(N,{style:{backgroundColor:e.toUpperCase()===g.toUpperCase()?y.palette.primary.main:y.palette.common.white},elevation:0,children:(0,n.jsx)(h.Z,{style:{color:e.toUpperCase()===g.toUpperCase()?y.palette.common.black:y.palette.primary.main},disabled:e.toUpperCase()===g.toUpperCase(),onClick:()=>{u(e)},children:e})},t))]})]})})})}function R(){let e=(0,v.Z)(),t=a(7218),o=(0,i.useRef)([!0,!0,!0,!0,!0,!1,!1]),[c,d]=(0,i.useState)(""),[u,p]=(0,i.useState)({state:!1,q:""}),[h,m]=(0,i.useState)(),[x,y]=(0,i.useState)(""),[f,b]=(0,i.useState)({open:!1}),[j,_]=(0,i.useState)("created"),Z=()=>{b({...f,open:!1}),o.current[3]=!0},k=e=>{b(e),o.current[3]=!0},w=e=>{d(e),o.current[6]=!0},S=e=>{m(e)},A=e=>{_(e),o.current[4]=!0},L=e=>{p(e),o.current[5]=!0},q=async e=>{if(!0===e){let e=C.Am.loading("Fetching Issues...");o.current[2]=!0,console.log("trigger reload"),await t.request({method:"get",maxBodyLength:1/0,url:"https://github-get-token-api.vercel.app/api/get-issues-sort?token="+"".concat(x)+"&sort="+"".concat(j)+"&tag="+"".concat(c)}).then(t=>{console.log(t);let a=t.data.map(e=>{let t=e.labels.map(e=>({color:e.color,description:e.description,name:e.name,url:e.url}));return{state:e.state,labels:t,assignee_name:e.assignee.login,assignee_avatar_url:e.assignee.avatar_url,repository_name:e.repository.name,date_created_at:e.created_at,date_updated_at:e.updated_at,url:e.url,title:e.title,body:e.body,html_url:e.html_url,labels_url:e.labels_url.replace("{/name}","")}});m(a),C.Am.update(e,{render:"Issues Loaded successfully",type:"success",isLoading:!1,autoClose:2500})}).catch(t=>{console.log(t),C.Am.update(e,{render:"Something went wrong",type:"error",isLoading:!1,autoClose:2500})})}},E=async e=>{let a=C.Am.loading("Fetching Issues...");o.current[2]=!0,console.log("trigger reload"),await t.request({method:"get",maxBodyLength:1/0,url:"https://github-get-token-api.vercel.app/api/search-query?token="+"".concat(x)+"&query="+"".concat(e)+"&sort="+"".concat(j)+"&tag="+"".concat(c)}).then(e=>{console.log(e.data.items);let t=e.data.items.map(e=>{let t=e.labels.map(e=>({color:e.color,description:e.description,name:e.name,url:e.url}));return{state:e.state,labels:t,assignee_name:e.assignee.login,assignee_avatar_url:e.assignee.avatar_url,repository_name:e.repository_url.substring(e.repository_url.lastIndexOf("/")+1),date_created_at:e.created_at,date_updated_at:e.updated_at,url:e.url,title:e.title,body:e.body,html_url:e.html_url,labels_url:e.labels_url.replace("{/name}","")}});m(t),C.Am.update(a,{render:"Issues Loaded successfully",type:"success",isLoading:!1,autoClose:2500})}).catch(e=>{console.log(e),C.Am.update(a,{render:"Something went wrong",type:"error",isLoading:!1,autoClose:2500})})};return(0,i.useEffect)(()=>{o.current[3]&&(o.current[3]=!1,console.log(f))},[f]),(0,i.useEffect)(()=>{if(o.current[0]){var e;o.current[0]=!1;let a=null!==(e=localStorage.getItem("github_access_key"))&&void 0!==e?e:"";!function(e){t.request({method:"get",maxBodyLength:1/0,url:"https://github-get-token-api.vercel.app/api/validate?key="+"".concat(e)}).then(t=>{200===t.status&&(y(e),console.log("using local_key"))}).catch(e=>{localStorage.clear()})}(a);let n=window.location.search,l=new URLSearchParams(n);if(l.get("code")){let e=l.get("code");console.log("code:"+e),t.request({method:"get",maxBodyLength:1/0,url:"https://github-get-token-api.vercel.app/api/get?code="+"".concat(e)}).then(e=>{console.log(JSON.stringify(e.data)),y(e.data.access_token),localStorage.setItem("github_access_key",e.data.access_token)}).catch(e=>{console.log(e)})}}},[]),(0,i.useEffect)(()=>{o.current[4]&&""!==x&&(o.current[4]=!1,u.state?E(u.q):q(!0))},[j]),(0,i.useEffect)(()=>{o.current[1]&&""!==x&&(o.current[1]=!1,q(!0))},[x]),(0,i.useEffect)(()=>{o.current[2]&&void 0!==h&&(o.current[2]=!1,console.log("this is issue",h))},[h]),(0,i.useEffect)(()=>{o.current[5]&&(o.current[5]=!1,""!==u.q&&u.state?E(u.q):q(!0))},[u]),(0,i.useEffect)(()=>{o.current[6]&&(o.current[6]=!1,""!==u.q&&u.state?E(u.q):q(!0))},[c]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.ZP,{}),(0,n.jsxs)(l(),{children:[(0,n.jsx)("title",{children:"2023 Frontend Intern Homework"}),(0,n.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsxs)(r.Z,{style:{backgroundColor:e.palette.secondary.main,minHeight:"100vh",minWidth:"1130px"},maxWidth:"xl",disableGutters:!0,children:[(0,n.jsx)(g,{clientid:"9413d76463c0af53a8a0"}),(0,n.jsx)(P,{tag:c,setTag:w,setQuery:L,setIssues:S,token:x,LoadIssue:q,setSortOrder:A,sortOrder:j}),void 0!==h&&(0,n.jsx)(I,{setTag:w,query:u,SearchQuery:E,Data:h,token:x,callback:k,LoadIssue:q}),(0,n.jsx)(D,{query:u,SearchQuery:E,updateForm:f,handleClose:Z,token:x,LoadIssue:q}),(0,n.jsx)(C.Ix,{position:"top-right",autoClose:2500,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})]})}}},function(e){e.O(0,[885,859,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);